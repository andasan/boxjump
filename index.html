<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Platformer - Box Jump</title>
		<style>
			*{ margin: 0; padding: 0;}
			body{
				background-color: rgb(80, 80, 80);
			}
			canvas {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
			}
		</style>
	</head>

<body>
	<header></header>
	<canvas id="canvas"></canvas>
	<footer></footer>

	<script>
	(function () {
		//constant rendering or the game's looping logic || all browser support
		var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
		window.requestAnimationFrame = requestAnimationFrame;
	});

	//variable declarations
	const GAME_WIDTH = 700, GAME_HEIGHT = 200;
	var canvas = document.getElementById("canvas"),
		context = canvas.getContext("2d"),
		width = GAME_WIDTH,
		height = GAME_HEIGHT,
		player = {
			x: 0,
			y: height - 100,
			width: 20,
			height: 20,
			speed: 3,
			velX: 0,
			velY: 0,
			jumping: false
		},
		floor = {
			x: 0,
			y: height - 50,
			width: GAME_WIDTH,
			height: 20
		}
		levels = 1,
		keys = [],
		friction = 0.8,
		gravity = 0.3;

	//apply var WxH onto element's dimension
	console.log(typeof(canvas));
	canvas.width = width;
	canvas.height = height;

	function Wall(color, x, y, width, height){
        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
		this.color = color;
		this.draw = function(){
			context.fillStyle = this.color;
			context.fillRect(this.x, this.y, this.width, this.height);
		};
		this.update = function(){
			this.draw();
		}
	}
	
	var Wall1 = new Wall("white",300,floor.y-50,20,50);

	//where the fun begins
	function updateGame() {
		player.velX++;
		player.velX *= friction;
		player.velY += gravity;
		player.x += player.velX;
		player.y += player.velY;

		// check for up keys
		if (keys[38] || keys[32]) {
			// up arrow or space
			if (!player.jumping) {
				player.jumping = true;
				player.velY = -player.speed * 2;
				console.log(-player.speed);
				console.log(player.velY);
			}
		}

		// floor collision
		if(player.y >= floor.y - player.height){
			player.y = floor.y - player.height;
			player.jumping = false;
		}

		//player hits the end
		if((player.x + player.width) >= width){
			player.x = 0;
			levels++;
			return;//example to exit out of function
		}
		
        
		//draws the player onto the canvas
		context.clearRect(0, 0, width, height);

		context.fillStyle = "orange";
		context.fillRect(player.x, player.y, player.width, player.height);
		
		// context.fillStyle = "white";
		context.font = "20px Verdana";
		context.fillText("Level: "+levels, 0, 20);

		context.fillStyle = "white";
		context.fillRect(floor.x, floor.y, floor.width, floor.height);

		//loop
		requestAnimationFrame(updateGame);
		Wall1.update();
	}

	document.body.addEventListener("keydown", function (e) {
		keys[e.keyCode] = true;
	});

	document.body.addEventListener("keyup", function (e) {
		keys[e.keyCode] = false;
	});

	window.addEventListener("load", function () {
		updateGame();
	});
	</script>
</body>
</html>

